
from airflow.models import DAG
from airflow.providers.apache.spark.operators.spark_sql import SparkSqlOperator
from airflow.providers.jdbc.operators.jdbc import JdbcOperator
from airflow.utils.dates import days_ago
from datetime import timedelta, datetime as dt

args = {
    'owner': 'Seshu Edala',
}

with DAG(
    dag_id='ESC_EDW_ETL_DAG_01',
    default_args=args,
    schedule_interval='@daily',
    dagrun_timeout=timedelta(minutes=60),
    start_date=days_ago(1),
    tags=(['ESC_EDW_ETL_DAG_01', 'etl'] + ['miller', 'robert', 'insert', 'song', 'artist', 'select', 'album', 'record_label', 'delete']),
    catchup=False,
    
) as dag:
                task_sql_queries_sql02_sql_1_60 = JdbcOperator(sql=f'''INSERT INTO song VALUES(32,13,'Within[space]You[space]Without[space]You',5.066);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_60", dag=dag,)
                task_sql_queries_sql02_sql_1_8 = JdbcOperator(sql=f'''INSERT INTO Artist VALUES(5, 2,'ZZ[space]Top');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_8", dag=dag,)
                task_sql_queries_sql02_sql_1_32 = JdbcOperator(sql=f'''INSERT INTO song VALUES(4,2,'Sad[space]But[space]True',5.29);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_32", dag=dag,)
                task_sql_queries_sql02_sql_1_30 = JdbcOperator(sql=f'''INSERT INTO song VALUES(2,1,'Blackened',6.42);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_30", dag=dag,)
                task_sql_queries_sql02_sql_1_7 = JdbcOperator(sql=f'''INSERT INTO Artist VALUES(4, 2,'Eric[space]Clapton');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_7", dag=dag,)
                task_sql_queries_sql02_sql_1_34 = JdbcOperator(sql=f'''INSERT INTO song VALUES(6,3,'Battery',5.13);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_34", dag=dag,)
                task_sql_queries_sql02_sql_1_5 = JdbcOperator(sql=f'''INSERT INTO Artist VALUES(2, 1,'Megadeth');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_5", dag=dag,)
                task_sql_queries_sql02_sql_1_58 = JdbcOperator(sql=f'''INSERT INTO song VALUES(30,13,'She''s[space]Leaving[space]Home', 3.5833);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_58", dag=dag,)
                task_sql_queries_sql01_sql_2_7 = JdbcOperator(sql=f'''INSERT INTO record_label VALUES(4,'MCA');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql01_sql_2_7", dag=dag,)
                task_sql_queries_sql03_sql_3_17 = JdbcOperator(sql=f'''SELECT ar.name 'Artist[space]Name',        avg(s.duration) 'Average[space]Song[space]Duration[space](min)' FROM song s JOIN album al ON s.album_id = al.id JOIN artist ar ON al.artist_id = ar.id GROUP BY ar.name ORDER BY avg(s.duration) DESC LIMIT 3 ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_17", dag=dag,)
                task_sql_queries_sql03_sql_3_11 = JdbcOperator(sql=f'''SELECT al.year 'Year',        count(*) 'Number[space]of[space]Albums[space]Recorded' FROM album al GROUP BY al.year ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_11", dag=dag,)
                task_sql_queries_sql01_sql_2_8 = JdbcOperator(sql=f'''INSERT INTO record_label VALUES(5,'Elektra');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql01_sql_2_8", dag=dag,)
                task_sql_queries_sql02_sql_1_22 = JdbcOperator(sql=f'''INSERT INTO album VALUES(8, 4, 'Riding[space]with[space]the[space]King',2000);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_22", dag=dag,)
                task_sql_queries_sql02_sql_1_20 = JdbcOperator(sql=f'''INSERT INTO album VALUES(6, 3, 'The[space]Greater[space]of[space]2[space]Evils',2004);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_20", dag=dag,)
                task_sql_queries_sql02_sql_1_6 = JdbcOperator(sql=f'''INSERT INTO Artist VALUES(3, 1,'Anthrax');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_6", dag=dag,)
                task_sql_queries_sql02_sql_1_46 = JdbcOperator(sql=f'''INSERT INTO song VALUES(18,9,'Legs',4.32);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_46", dag=dag,)
                task_sql_queries_sql02_sql_1_39 = JdbcOperator(sql=f'''INSERT INTO song VALUES(11,6,'Madhouse',4.26);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_39", dag=dag,)
                task_artist = JdbcOperator(sql=f'''SELECT 1; -- FIXME ARTIST;''', jdbc_conn_id='airflow_conn_id', task_id="task_artist", dag=dag,)
                task_sql_queries_sql02_sql_1_24 = JdbcOperator(sql=f'''INSERT INTO album VALUES(10, 6, 'Greatest[space]Hits',2004);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_24", dag=dag,)
                task_sql_queries_sql02_sql_1_25 = JdbcOperator(sql=f'''INSERT INTO album VALUES(11, 7, 'All-Time[space]Greatest[space]Hits',1975);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_25", dag=dag,)
                task_sql_queries_sql02_sql_1_10 = JdbcOperator(sql=f'''INSERT INTO Artist VALUES(7, 3,'Lynyrd[space]Skynyrd');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_10", dag=dag,)
                task_sql_queries_sql02_sql_1_12 = JdbcOperator(sql=f'''INSERT INTO Artist VALUES(9, 6,'The[space]Beatles');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_12", dag=dag,)
                task_sql_queries_sql02_sql_1_27 = JdbcOperator(sql=f'''INSERT INTO album VALUES(13, 9, 'Sgt.[space]Pepper''s[space]Lonely[space]Hearts[space]Club[space]Band', 1967);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_27", dag=dag,)
                task_sql_queries_sql03_sql_3_12 = JdbcOperator(sql=f'''SELECT max(COUNT) 'Max[space]Number[space]of[space]Albums[space]Recorded[space]per[space]year[space]for[space]all[space]Years' FROM   (SELECT al.year 'Year',           count(*) COUNT    FROM album al    GROUP BY al.year) AS TEMP ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_12", dag=dag,)
                task_sql_queries_sql03_sql_3_13 = JdbcOperator(sql=f'''SELECT al.year 'Year',        count(*) 'Max[space]Number[space]of[space]Albums[space]Recorded' FROM album al GROUP BY al.year HAVING count(*) =   (SELECT max(COUNT)    FROM      (SELECT al.year 'Year',              count(*) COUNT       FROM album al       GROUP BY al.year) AS TEMP) ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_13", dag=dag,)
                task_sql_queries_sql03_sql_3_10 = JdbcOperator(sql=f'''SELECT ar.name 'Artist[space]Name',        al.name 'Album[space]Name',        s.name 'Song',        al.year 'Year[space]Recorded',        s.duration 'Duration' FROM song s JOIN album al ON s.album_id = al.id JOIN artist ar ON al.artist_id = ar.id ORDER BY s.duration DESC LIMIT 5 ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_10", dag=dag,)
                task_sql_queries_sql02_sql_1_17 = JdbcOperator(sql=f'''INSERT INTO album VALUES(3, 1, 'Master[space]of[space]Puppets',1986);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_17", dag=dag,)
                task_sql_queries_sql01_sql_2_9 = JdbcOperator(sql=f'''INSERT INTO record_label VALUES(6,'Capitol');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql01_sql_2_9", dag=dag,)
                task_sql_queries_sql02_sql_1_63 = JdbcOperator(sql=f'''INSERT INTO song VALUES(35,13,'Good[space]Morning[space]Good[space]Morning', 2.6833);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_63", dag=dag,)
                task_sql_queries_sql03_sql_3_8 = JdbcOperator(sql=f'''SELECT ar.name 'Artist[space]Name',        al.name 'Album[space]Name', count(*) 'Number[space]of[space]Songs[space]less[space]than[space]5[space]minutes' FROM song s JOIN album al ON s.album_id = al.id JOIN artist ar ON al.artist_id = ar.id WHERE duration < 5 GROUP BY ar.name,          al.name ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_8", dag=dag,)
                task_sql_queries_sql02_sql_1_19 = JdbcOperator(sql=f'''INSERT INTO album VALUES(5, 2, 'Peace[space]Sells',1986);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_19", dag=dag,)
                task_sql_queries_sql02_sql_1_35 = JdbcOperator(sql=f'''INSERT INTO song VALUES(7,4,'Dialectic[space]Chaos',2.26);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_35", dag=dag,)
                task_sql_queries_sql03_sql_3_5 = JdbcOperator(sql=f'''SELECT ar.name 'Artist[space]Name',        count(*) 'Number[space]of[space]Songs[space]Recorded' FROM song s JOIN album al ON s.album_id = al.id JOIN artist ar ON al.artist_id = ar.id GROUP BY ar.name HAVING count(*) =   (SELECT min(n)    FROM      (SELECT ar.name a,              count(*) n       FROM song s       JOIN album al ON s.album_id = al.id       JOIN artist ar ON al.artist_id = ar.id       GROUP BY ar.name) temp1) ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_5", dag=dag,)
                task_sql_queries_sql03_sql_3_15 = JdbcOperator(sql=f'''SELECT ar.name 'Artist[space]Name',        al.name 'Album[space]Name' FROM artist ar LEFT JOIN album al ON ar.id = al.artist_id LEFT JOIN song s ON s.album_id = al.id AND s.duration < 5 WHERE s.name IS NULL ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_15", dag=dag,)
                task_sql_queries_sql02_sql_1_42 = JdbcOperator(sql=f'''INSERT INTO song VALUES(14,7,'Modern[space]Girl',4.49);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_42", dag=dag,)
                task_sql_queries_sql02_sql_1_56 = JdbcOperator(sql=f'''INSERT INTO song VALUES(28,13,'Getting[space]Better', 2.80);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_56", dag=dag,)
                task_sql_queries_sql02_sql_1_44 = JdbcOperator(sql=f'''INSERT INTO song VALUES(16,8,'Key[space]to[space]the[space]Highway',3.39);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_44", dag=dag,)
                task_sql_queries_sql02_sql_1_31 = JdbcOperator(sql=f'''INSERT INTO song VALUES(3,2,'Enter[space]Sandman',5.3);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_31", dag=dag,)
                task_sql_queries_sql02_sql_1_38 = JdbcOperator(sql=f'''INSERT INTO song VALUES(10,5,'The[space]Conjuring',5.09);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_38", dag=dag,)
                task_sql_queries_sql01_sql_2_4 = JdbcOperator(sql=f'''INSERT INTO record_label VALUES(1,'Blackened');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql01_sql_2_4", dag=dag,)
                task_sql_queries_sql03_sql_3_2 = JdbcOperator(sql=f'''SELECT r.name `Record Label Name` FROM record_label r LEFT JOIN artist a ON r.id = a.record_label_id WHERE a.record_label_id IS NULL ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_2", dag=dag,)
                task_sql_queries_sql02_sql_1_65 = JdbcOperator(sql=f'''INSERT INTO song VALUES(37,13,'A[space]Day[space]in[space]the[space]Life', 5.65);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_65", dag=dag,)
                task_sql_queries_sql02_sql_1_16 = JdbcOperator(sql=f'''INSERT INTO album VALUES(2, 1, 'Black[space]Album',1991);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_16", dag=dag,)
                task_sql_queries_sql02_sql_1_55 = JdbcOperator(sql=f'''INSERT INTO song VALUES(27,13,'Lucy[space]in[space]the[space]Sky[space]with[space]Diamonds', 3.4666);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_55", dag=dag,)
                task_sql_queries_sql02_sql_1_41 = JdbcOperator(sql=f'''INSERT INTO song VALUES(13,7,'Reptile',3.36);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_41", dag=dag,)
                task_sql_queries_sql02_sql_1_40 = JdbcOperator(sql=f'''INSERT INTO song VALUES(12,6,'I[space]am[space]the[space]Law',6.03);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_40", dag=dag,)
                task_sql_queries_sql03_sql_3_9 = JdbcOperator(sql=f'''SELECT al.year 'Year',        count(*) 'Number[space]of[space]Songs[space]Recorded' FROM song s JOIN album al ON s.album_id = al.id JOIN artist ar ON al.artist_id = ar.id GROUP BY al.year HAVING count(*) =   (SELECT max(COUNT)    FROM      (SELECT al.year,              count(*) COUNT       FROM song s       JOIN album al ON s.album_id = al.id       JOIN artist ar ON al.artist_id = ar.id       GROUP BY al.year) AS TEMP) ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_9", dag=dag,)
                task_sql_queries_sql02_sql_1_50 = JdbcOperator(sql=f'''INSERT INTO song VALUES(22,11,'Free[space]Bird',14.23);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_50", dag=dag,)
                task_sql_queries_sql02_sql_1_66 = JdbcOperator(sql=f'''INSERT INTO song SELECT id,        artist_id,        name,        5 FROM album;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_66", dag=dag,)
                task_sql_queries_sql02_sql_1_33 = JdbcOperator(sql=f'''INSERT INTO song VALUES(5,3,'Master[space]of[space]Puppets',8.35);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_33", dag=dag,)
                task_sql_queries_sql02_sql_1_62 = JdbcOperator(sql=f'''INSERT INTO song VALUES(34,13,'Lovely[space]Rita', 2.7);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_62", dag=dag,)
                task_sql_queries_sql03_sql_3_7 = JdbcOperator(sql=f'''SELECT temp.artist 'Artist[space]Name',        count(*) 'Number[space]of[space]Songs[space]greater[space]than[space]5[space]minutes' FROM   (SELECT ar.name artist,           s.duration 'duration'    FROM song s    JOIN album al ON s.album_id = al.id    JOIN artist ar ON al.artist_id = ar.id    WHERE duration > 5 ) AS TEMP GROUP BY temp.artist ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_7", dag=dag,)
                task_sql_queries_sql03_sql_3_14 = JdbcOperator(sql=f'''SELECT ar.name 'Artist[space]Name',        sum(s.duration) 'Total[space]Duration[space]of[space]All[space]Songs' FROM song s JOIN album al ON s.album_id = al.id JOIN artist ar ON al.artist_id = ar.id GROUP BY ar.name ORDER BY sum(s.duration) DESC ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_14", dag=dag,)
                task_sql_queries_sql03_sql_3_1 = JdbcOperator(sql=f'''SELECT ar.name 'Artist[space]Name',        r.name 'Record[space]Label[space]Name' FROM record_label r JOIN artist ar ON r.id = ar.record_label_id ORDER BY ar.name ASC ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_1", dag=dag,)
                task_album = JdbcOperator(sql=f'''SELECT 1; -- FIXME ALBUM;''', jdbc_conn_id='airflow_conn_id', task_id="task_album", dag=dag,)
                task_sql_queries_sql02_sql_1_47 = JdbcOperator(sql=f'''INSERT INTO song VALUES(19,10,'Eruption',1.43);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_47", dag=dag,)
                task_sql_queries_sql02_sql_1_43 = JdbcOperator(sql=f'''INSERT INTO song VALUES(15,8,'Riding[space]with[space]the[space]King',4.23);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_43", dag=dag,)
                task_record_label = JdbcOperator(sql=f'''SELECT 1; -- FIXME RECORD_LABEL;''', jdbc_conn_id='airflow_conn_id', task_id="task_record_label", dag=dag,)
                task_sql_queries_sql02_sql_1_14 = JdbcOperator(sql=f'''INSERT INTO album VALUES(1, 1, '...And[space]Justice[space]For[space]All',YEAR(CURRENT_DATE));''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_14", dag=dag,)
                task_sql_queries_sql02_sql_1_48 = JdbcOperator(sql=f'''INSERT INTO song VALUES(20,10,'Hot[space]For[space]Teacher',4.43);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_48", dag=dag,)
                task_sql_queries_sql02_sql_1_67 = JdbcOperator(sql=f'''DELETE FROM album WHERE name = 'Endgame';''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_67", dag=dag,)
                task_sql_queries_sql03_sql_3_6 = JdbcOperator(sql=f'''SELECT count(*) 'Number[space]of[space]Artists[space]Having[space]Recorded[space]the[space]Least[space]Number[space]of[space]Songs' FROM   (SELECT ar.name Artist,           count(*)    FROM song s    JOIN album al ON s.album_id = al.id    JOIN artist ar ON al.artist_id = ar.id    GROUP BY ar.name    HAVING count(*) =      (SELECT min(n)       FROM         (SELECT ar.name a,                 count(*) n          FROM song s          JOIN album al ON s.album_id = al.id          JOIN artist ar ON al.artist_id = ar.id          GROUP BY ar.name) temp1)) temp2 ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_6", dag=dag,)
                task_sql_queries_sql02_sql_1_11 = JdbcOperator(sql=f'''INSERT INTO Artist VALUES(8, 3,'AC/DC');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_11", dag=dag,)
                task_sql_queries_sql03_sql_3_19 = JdbcOperator(sql=f'''SELECT DISTINCT ar.name 'Artist[space]Name' FROM artist ar LEFT JOIN album al ON ar.id = al.artist_id AND YEAR >= 1980 AND YEAR <= 1990 WHERE YEAR IS NULL ORDER BY ar.name ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_19", dag=dag,)
                task_sql_queries_sql02_sql_1_21 = JdbcOperator(sql=f'''INSERT INTO album VALUES(7, 4, 'Reptile',2001);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_21", dag=dag,)
                task_sql_queries_sql02_sql_1_61 = JdbcOperator(sql=f'''INSERT INTO song VALUES(33,13,'When[space]I''m[space]Sixty-Four',2.6166);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_61", dag=dag,)
                task_sql_queries_sql02_sql_1_36 = JdbcOperator(sql=f'''INSERT INTO song VALUES(8,4,'Endgame',5.57);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_36", dag=dag,)
                task_sql_queries_sql02_sql_1_57 = JdbcOperator(sql=f'''INSERT INTO song VALUES(29,13,'Fixing[space]a[space]Hole', 2.60);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_57", dag=dag,)
                task_sql_queries_sql02_sql_1_9 = JdbcOperator(sql=f'''INSERT INTO Artist VALUES(6, 2,'Van[space]Halen');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_9", dag=dag,)
                task_sql_queries_sql02_sql_1_51 = JdbcOperator(sql=f'''INSERT INTO song VALUES(23,12,'Thunderstruck',4.52);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_51", dag=dag,)
                task_sql_queries_sql03_sql_3_16 = JdbcOperator(sql=f'''SELECT ar.name AS 'Artist[space]Name',        al.name AS 'Album[space]Name',        s.name AS 'Song',        s.duration AS 'Duration' FROM artist ar JOIN album al ON al.artist_id = ar.id JOIN song s ON s.album_id = al.id ORDER BY ar.name ASC,          al.name ASC,          s.name ASC ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_16", dag=dag,)
                task_sql_queries_sql01_sql_2_5 = JdbcOperator(sql=f'''INSERT INTO record_label VALUES(2,'Warner[space]Bros');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql01_sql_2_5", dag=dag,)
                task_sql_queries_sql02_sql_1_37 = JdbcOperator(sql=f'''INSERT INTO song VALUES(9,5,'Peace[space]Sells',4.09);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_37", dag=dag,)
                task_sql_queries_sql02_sql_1_49 = JdbcOperator(sql=f'''INSERT INTO song VALUES(21,11,'Sweet[space]Home[space]Alabama',4.45);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_49", dag=dag,)
                task_sql_queries_sql02_sql_1_23 = JdbcOperator(sql=f'''INSERT INTO album VALUES(9, 5, 'Greatest[space]Hits',1992);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_23", dag=dag,)
                task_sql_queries_sql02_sql_1_53 = JdbcOperator(sql=f'''INSERT INTO song VALUES(25,13,'Sgt.[space]Pepper''s[space]Lonely[space]Hearts[space]Club[space]Band', 2.0333);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_53", dag=dag,)
                task_sql_queries_sql02_sql_1_26 = JdbcOperator(sql=f'''INSERT INTO album VALUES(12, 8, 'Greatest[space]Hits',2003);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_26", dag=dag,)
                task_sql_queries_sql02_sql_1_4 = JdbcOperator(sql=f'''INSERT INTO Artist VALUES(1, 1,'Metallica');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_4", dag=dag,)
                task_song = JdbcOperator(sql=f'''SELECT 1; -- FIXME SONG;''', jdbc_conn_id='airflow_conn_id', task_id="task_song", dag=dag,)
                task_sql_queries_sql03_sql_3_4 = JdbcOperator(sql=f'''SELECT ar.name 'Artist[space]Name',        count(*) 'Number[space]of[space]Songs' FROM song s JOIN album al ON s.album_id = al.id JOIN artist ar ON al.artist_id = ar.id GROUP BY ar.name ORDER BY count(*) DESC LIMIT 1 ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_4", dag=dag,)
                task_sql_queries_sql02_sql_1_59 = JdbcOperator(sql=f'''INSERT INTO song VALUES(31,13,'Being[space]for[space]the[space]Benefit[space]of[space]Mr.[space]Kite!',2.6166);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_59", dag=dag,)
                task_sql_queries_sql02_sql_1_45 = JdbcOperator(sql=f'''INSERT INTO song VALUES(17,9,'Sharp[space]Dressed[space]Man',4.15);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_45", dag=dag,)
                task_sql_queries_sql02_sql_1_52 = JdbcOperator(sql=f'''INSERT INTO song VALUES(24,12,'T.N.T',3.35);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_52", dag=dag,)
                task_sql_queries_sql02_sql_1_54 = JdbcOperator(sql=f'''INSERT INTO song VALUES(26,13,'With[space]a[space]Little[space]Help[space]from[space]My[space]Friends', 2.7333);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_54", dag=dag,)
                task_sql_queries_sql02_sql_1_18 = JdbcOperator(sql=f'''INSERT INTO album VALUES(4, 2, 'Endgame',2009);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_18", dag=dag,)
                task_sql_queries_sql03_sql_3_18 = JdbcOperator(sql=f'''SELECT al.name 'Album[space]Name',        floor(sum(s.duration)) 'Minutes',        round(mod(sum(s.duration), 1) * 60) 'Seconds' FROM album al JOIN song s ON s.album_id = al.id WHERE al.name like 'Sgt.[space]Pepper%' GROUP BY al.name ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_18", dag=dag,)
                task_sql_queries_sql02_sql_1_64 = JdbcOperator(sql=f'''INSERT INTO song VALUES(36,13,'Sgt.[space]Pepper''s[space]Lonely[space]Hearts[space]Club[space]Band[space](Reprise)', 1.3166);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_64", dag=dag,)
                task_sql_queries_sql02_sql_1_29 = JdbcOperator(sql=f'''INSERT INTO song VALUES(1,1,'One',7.25);''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql02_sql_1_29", dag=dag,)
                task_sql_queries_sql01_sql_2_6 = JdbcOperator(sql=f'''INSERT INTO record_label VALUES(3,'Universal');''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql01_sql_2_6", dag=dag,)
                task_sql_queries_sql03_sql_3_20 = JdbcOperator(sql=f'''SELECT DISTINCT ar.name 'Artist[space]Name' FROM artist ar LEFT JOIN album al ON ar.id = al.artist_id AND YEAR >= 1980 AND YEAR <= 1990 WHERE YEAR IS NOT NULL ORDER BY ar.name ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_20", dag=dag,)
                task_sql_queries_sql03_sql_3_3 = JdbcOperator(sql=f'''SELECT ar.name 'Artist[space]Name',        count(*) 'Number[space]of[space]Songs' FROM song s JOIN album al ON s.album_id = al.id JOIN artist ar ON al.artist_id = ar.id GROUP BY ar.name ORDER BY count(*) DESC ;''', jdbc_conn_id='airflow_conn_id', task_id="task_sql_queries_sql03_sql_3_3", dag=dag,)
                task_end = JdbcOperator(sql=f'''-- FINISHED EXECUTION;''', jdbc_conn_id='airflow_conn_id', task_id="task_end", dag=dag,)
                
                task_end.set_upstream(task_sql_queries_sql03_sql_3_20)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_8)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_6)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_1)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_19)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_5)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_10)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_13)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_14)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_15)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_4)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_16)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_3)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_7)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_17)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_2)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_12)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_9)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_18)
                task_end.set_upstream(task_sql_queries_sql03_sql_3_11)
                task_sql_queries_sql03_sql_3_20.set_upstream(task_album)
                task_sql_queries_sql03_sql_3_20.set_upstream(task_artist)
                task_sql_queries_sql03_sql_3_8.set_upstream(task_song)
                task_sql_queries_sql03_sql_3_1.set_upstream(task_record_label)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_17)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_23)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_22)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_67)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_21)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_16)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_18)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_20)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_26)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_14)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_19)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_24)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_25)
                task_album.set_upstream(task_sql_queries_sql02_sql_1_27)
                task_artist.set_upstream(task_sql_queries_sql02_sql_1_10)
                task_artist.set_upstream(task_sql_queries_sql02_sql_1_7)
                task_artist.set_upstream(task_sql_queries_sql02_sql_1_8)
                task_artist.set_upstream(task_sql_queries_sql02_sql_1_9)
                task_artist.set_upstream(task_sql_queries_sql02_sql_1_5)
                task_artist.set_upstream(task_sql_queries_sql02_sql_1_11)
                task_artist.set_upstream(task_sql_queries_sql02_sql_1_12)
                task_artist.set_upstream(task_sql_queries_sql02_sql_1_6)
                task_artist.set_upstream(task_sql_queries_sql02_sql_1_4)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_32)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_42)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_31)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_63)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_34)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_53)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_46)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_38)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_48)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_51)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_64)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_29)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_66)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_65)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_49)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_30)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_33)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_54)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_59)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_40)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_45)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_39)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_60)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_47)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_36)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_52)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_35)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_50)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_56)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_58)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_41)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_55)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_37)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_44)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_62)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_61)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_43)
                task_song.set_upstream(task_sql_queries_sql02_sql_1_57)
                task_record_label.set_upstream(task_sql_queries_sql01_sql_2_9)
                task_record_label.set_upstream(task_sql_queries_sql01_sql_2_8)
                task_record_label.set_upstream(task_sql_queries_sql01_sql_2_7)
                task_record_label.set_upstream(task_sql_queries_sql01_sql_2_6)
                task_record_label.set_upstream(task_sql_queries_sql01_sql_2_5)
                task_record_label.set_upstream(task_sql_queries_sql01_sql_2_4)
